# 1장 HTTP 개관

> 이번 장에서는 HTTP에 대하여 간결하게 설명한다. 가령 얼마나 많은 클라이언트와 서버가 통신하는지, 리소스가 어디서 오는지, 웹 트랜잭션이 어떻게 동작하는지, HTTP 통신을 위해 사용하는 메시지의 형식이라던지, HTTP 기저의 TCP 네트워크 전송이라던지, 여러 종류의 HTTP 프로토콜이라던지, 여러 곳곳에 설치된 다양한 HTTP 구성요소라던지에 대한 궁금증을 개략적으로 결할 수 있을 것이다.

<br>

## 1.1 HTTP : 인터넷의 멀티미디어 배달부

- HTTP는 jpeg이미지, html페이지, 동영상 파일, 음성 파일 등을 웹 서버로부터 빠르고, 간편하고, 정확하게 사람들의 pc에 설치된 웹 브라우저로 옮겨준다.

- 신뢰성이 있는 데이터 전송 프로토콜을 사용하여 전송 중 손상되거나 꼬이지 않음을 보장해준다. 이는 사용자에게도 안전한 통신을 보장지만 개발자도 인터넷의 결함이나 약점에 대한 걱정 없이 애플리케이션의 고유의 기능을 구현하는데 집중할 수 있게해준다.

<br>

## 1.2 웹 클라이언트와 서버

- HTTP 프로토콜로 의사소통을 하는 웹 서버를 보통 `HTTP 서버`라고 부른다.

- HTTP 클라이언트와 HTTP 서버는 월드 와이드 웹(WWW)의 기본 요소

- 웹 서버 (HTTP 서버)

  - 인터넷의 데이터(웹 콘텐츠)를 저장
  - HTTP 클라이언트가 요청한 데이터를 제공

- 웹 클라이언트

  - 서버에게 필요한 데이터를 HTTP 요청을 보냄.
  - 가장 흔한 클라이언트로는 인터넷 익스플로러, 크롬 같은 웹브라우저이다.

  ```
  웹브라우저 : 서버에게 HTTP 객체를 요청하고 사용자의 화면에 보여준다.
  ```

<br>

<center><img width="641" alt="client-server" src="https://user-images.githubusercontent.com/37801041/73855822-f5c72a80-4877-11ea-8e29-0a57e17f83c9.png"></center>
> 위의 그림은 클라이언트가  `http://www.hooong.com/index.html`주소로 페이지를 열려고 하는 상황이다. 웹브라우저는 HTTP 요청(request)을 `www.hooong.com` 이라는 서버로 보내고, 서버는 이 요청에서 찾는 'index.html' 객체를 서버 안에서 찾고, 찾는데 성공을 했다면 그것의 타입, 길이 등의 정보와 함께 HTTP 응답(response)에 실어 클라이언트에게 보내주고 클라이언트(즉, 웹브라우저)는 이를 렌더링하여 사용자에게 보여주게 된다.

<br>

## 1.3 리소스

- `웹 리소스` == `웹 콘텐츠의 원천`

- 웹 서버는 웹 리소스를 관리하고 제공한다.

  ```
  - 정적파일 : 텍스트 파일, HTML 파일, 워드 파일, JPEG 이미지, AVI 동영상 파일 등 모든 종류의 파일
  - 동적 콘텐츠 리소스 : 요청에 따라 콘텐츠를 생산하는 프로그램도 리소스가 될 수 있다. 즉, 사용자가 누구인지, 어떤 정보를 요청했는지, 몃 시인지에 따라 다른 콘텐츠를 생성 (라이브 영상, 주식거래 등)
  ```

- 따라서 어떤 종류의 컨텐츠 소스도 리소스가 될 수 있다. => 가령 기업 판매 예측 스프레드시트 파일도 리소스이고, 인터넷의 웹 검색엔진 역시 리소스이다.

  <br>

### 1.3.1 미디어 타입

- 수천 가지의 데이터 타입을 효율적으로 다루기 위하여 MIME (Multipurpose Internet Mail Extensions) 타입이라는 데이터 포맷 라벨을 붙임.

- 원래는 각기 다른 전자메일 시스템 사이에서 메시지가 오갈 때 겪는 문제점을 해결하기 위해 설계되었지만 이메일에서 워낙 작동을 잘해서 HTTP에서도 멀티미디어 콘텐츠를 기술하고 라벨을 붙이기 위해 체택되었다고 함.

- 웹브라우저는 서버로부터 응답을 받고 다룰 수 있는 객체인지 MIME 타입을 통해 확인.

- MIME 타입은 사선(/)으로 구분되며 주 타입(primary object type)와 부 타입(specific subtype)으로 이루어진 문자열 라벨.

  ```
  * JPEG 이미지
  Content-type: image/jpeg       
  
  * HTML 파일
  Content-type: text/html
  
  * plain ASCII 텍스트 문서
  Content-type: text/plain
  
  * json포맷의 파일
  Content-type: application/json
  
  * mp3 파일
  Content-type: audio/mpeg
  ```

  - 참고 : [https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Complete_list_of_MIME_types](https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Complete_list_of_MIME_types)

<br>

### 1.3.2 URI

- 통합 자원 식별자(Uniform Resource Identifier, URI)
- 정보 리소스를 고유하게 식별하고 위치를 지정할 수 있으며, 인터넷의 우편물 주소로 비유할 수 있다.
- HTTP는 주어진 URI를 가지고 객체를 찾아온다.
- URL과 URN, 두 가지가 있다.

<br>

### 1.3.3 URL

- 통합 자원 지시자(Uniform Resource Locator, URL)
- 특정 서버의 한 리소스에 대한 구체적인 위치를 서술
- 오늘날의 URI는 대부분 URL이다.

- URL의 표준 포맷

  1. 스킴(scheme) : 리소스에 접근하기 위해 사용되는 프로토콜

     예 :  `http://`

  2. 서버의 인터넷 주소

     예 : `www.hooong.com`

  3. 웹 서버의 리소스

     예 : `/index.html`

<br>

### 1.3.4 URN

- 통합 자원 이름(Uniform Resource Name, URN)

- 한 리소스에 대해, 그 리소스의 위치에 영향을 받지 않는 유일무이한 이름 역할

- 따라서 독립적인 URN은 리소스를 여기저기 옮기더라도 문제없이 동작

- 또한, 이름만 변하지 않는다면 여러 종류의 네트워크 접속 프로토콜로 접근해도 문제가 없다.

  ```
  urn:ietf:rfc:2141
  => 인터넷 표준 문서 'RFC 2141'을 지칭하기 위해 사용하는 URN
  ```

- 아직 실험 중인 상태로 널리 체택되지는 않았지만 전망은 밝다고한다.

<br>

## 1.4 트랜잭션

- 클라이언트가 웹 서버와 리소스를 주고받기 위한 상호작용
- HTTP 트랜잭션 = `요청 명령(클라이언트가 서버로 보내는)` + `응답 결과(서버가 클라이언트에게 돌려주는)`
- 트랜잭션은 `HTTP 메시지`라고 불리는 정형화된 데이터 덩어리를 이용해 이루어진다.
- HTTP 요청메시지는 명령과 URI를 포함
- HTTP 응답메시지는 트랜잭션의 결과를 포함

<br>

### 1.4.1 메서드

- HTTP는 메서드라는 여러 종류의 요청 명령을 지원한다.

- 모든 HTTP 요청 메시지는 반드시 한 개의 메서드를 갖는다.

- 서버에게 어떤 동작이 취해져야 하는지를 말해주는 역할을 한다.

- 흔히 쓰이는 HTTP 메서드

  ```
  GET    : 서버에게 특정 리소스를 요청
  PUT    : 클라이언트가 보내는 데이터를 지정한 이름의 리소스로 저장
  DELETE : 지정한 리소스를 서버에서 삭제
  POST   : 데이터를 서버 게이트웨이 애플리케이션으로 보냄
  HEAD   : 응답에서, HTTP 헤더 부분만 보냄
  ```

  <br>

### 1.4.2 상태코드

- 모든 HTTP 응답 메시지가 상태코드와 함께 반환된다.

- 상태코드는 요청이 성공했는지 아니면 추가 조치가 필요한지 등 상태를 알려주는 세 자리 숫자.

- HTTP는 상태코드에 숫자 말고도 텍스트로 된  `사유 구절`도 함께 보낸다.

  `200 OK` => 여기서 "OK"가 사유 구절이다.

- 흔히 쓰이는 상태 코드

  ```
  200 : OK, 요청을 성공
  302 : 다시 보내서 다른 곳으로 가서 리소스를 가져가라
  404 : NOT FOUND, 해당 리소스를 찾을 수 없음.
  ```

<br>

### 1.4.3 여러 객체로 이루어진 웹페이지

> 대부분의 애플리케이션은 하나의 작업을 수행하기 위하여 여러 HTTP 트랜잭션을 수행해야 한다. 가령, 웹페이지를 띄운다고 할때 HTML 문서를 한 번의 트랜잭션으로 가져온 뒤, 웹페이지 안에 띄워줄 이미지, 자바 애플릿 등을 가져오기 위해 추가적인 HTTP 트랜잭션을 필요로 한다. 즉, 웹페이지는 보통 하나의 리소스가 아니라 리소스의 모음이라 할 수 있다.

<br>

## 1.5 메시지

- 단순한 줄 단위의 문자열로 이루어져 이진 형식에 비해 이해하고 쓰기 쉽다.
- 시작줄(start-line), 헤더(headers), 본문(body)로 이루어져 있다.

<center><img width="906" alt="http_messages" src="https://user-images.githubusercontent.com/37801041/73928071-d8489e00-4915-11ea-9c88-631b728e40d2.png"></center>
- 시작줄 (Start-line) : 요청이라면 무엇을 해야 하는지, 응답이라면 무슨 일이 일어났는지를 나타낸다.
- 헤더 (Headers) : 0개 이상의 헤더 필드가 주어지며, 각 헤더 필드는 이름과 값이 콜론(:)으로 구분되어 구성되며, 마지막에는 빈 줄로 끝이 난다.
- 본문 (Body) : 본문에는 어떠한 종류의 데이터든 들어갈 수 있고, 필요에 따라 올 수 있다. 따라서 문자열로된 텍스트는 물론 이진 데이터로 된 이미지, 비디오 등의 데이터도 포함이 될 수 있다.



## 1.6 TCP 커넥션

- TCP는 다음을 제공해준다.

  - 오류 없는 데이터 전송 (신뢰성)

  - 순서에 맞게 전달

  - 조각나지 않는 데이터 스트림 (언제든 어떤 크기로든 보낼 수 있다.)

    <br>

- TCP/IP

  > TCP와 IP가 층을 이루는, 패킷 교환 네트워크 프로토콜의 집합으로, 각 네트워크와 하드웨어의 특성을 숨기고, 어떤 종류의 컴퓨터나 네트워크든 서로 신뢰성 있는 의사소통을 하게 해준다.

<br>

- TCP 통신을 하기 위해서는 IP 주소, 포트번호를 사용해 커넥션을 맺어야한다.

- IP 주소, 포트번호?

  ```
  http://127.0.0.1:80/index.html
  => IP 주소 : 127.0.0.1
  => 포트번호 : 80
  
  http://www.google.com/index.html
  => IP 주소 : www.google.com이라는 도메인 네임을 가지고 있다.
  => 포트번호 : 기본값으로 80포트를 사용
  ```

- 다음은 TCP/IP 통신의 과정이다.

  ```
  1. 웹브라우저가 서버의 URL에서 도메인 네임을 추출
  2. 웹브라우저가 서버의 도메인 네임을 IP 주소로 변환
  3. 웹브라우저가 URL에서 포트번호를 추출
  4. IP주소와 포트번호를 사용해 웹 서버와 TCP 커넥션을 맺음
  5. TCP 커넥션을 통해 HTTP 요청을 보냄
  6. 서버가 보내준 응답을 받음
  7. 통신이 끝나고 커넥션이 닫히면 웹브라우저는 문서를 보여준다.
  ```

  